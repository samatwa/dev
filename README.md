# Terraform + EKS

## Опис структури проєкту

```
lesson-6/
│
├── main.tf                  # Головний файл для підключення модулів
├── backend.tf               # Налаштування бекенду для стейтів (S3 + DynamoDB)
├── outputs.tf               # Загальні виводи ресурсів
├── modules/                 # Каталог з усіма модулями
│   │
│   ├── s3-backend/          # Модуль для S3 та DynamoDB
│   │
│   ├── vpc/                 # Модуль для VPC
│   │
│   ├── ecr/                 # Модуль для ECR 
│   │
│   └── eks/                 # Модуль для EKS
│       ├── eks.tf           # Створення EKS-кластера та воркерів
│       ├── variables.tf     # Змінні для EKS
│       ├── outputs.tf       # Виведення інформації про EKS
│       └── node.tf          # IAM-ролі для EKS
│
└── README.md                # Опис проєкту та інструкція
```

## Команди для ініціалізації та запуску

```bash
# Ініціалізація Terraform (завантаження провайдерів та модулів)
terraform init

# Створення плану виконання (показує, які ресурси будуть створені)
terraform plan

# Застосування змін (створення інфраструктури)
terraform apply

# Знищення інфраструктури
terraform destroy
```

## Пояснення кожного модуля

### s3-backend
Цей модуль відповідає за створення S3-бакета для зберігання файлів стану Terraform (`terraform.tfstate`) та таблиці DynamoDB для блокування стану, щоб уникнути конфліктів при одночасній роботі.

### vpc
Модуль `vpc` створює мережеву інфраструктуру, включаючи:
- **VPC**: Ізольований простір у хмарі AWS.
- **Підмережі**: Публічні та приватні підмережі для розміщення ресурсів.
- **Internet Gateway**: Для доступу до Інтернету з публічних підмереж.
- **NAT Gateway**: Для доступу до Інтернету з приватних підмереж без прямого доступу ззовні.
- **Маршрутизація**: Таблиці маршрутів для керування трафіком.

### ecr
Модуль `ecr` створює Elastic Container Registry (ECR) для зберігання, управління та розгортання Docker-образів. Він налаштовує репозиторій з автоматичним скануванням на вразливості при завантаженні нового образу.

### eks
Цей модуль відповідає за створення та налаштування Amazon EKS (Elastic Kubernetes Service). 
Він включає:
- **EKS Cluster**: Створення самого Kubernetes-кластера.
- **Node Group**: Налаштування групи EC2-інстансів (воркерів), які будуть виконувати робочі навантаження.
- **IAM Roles**: Створення необхідних IAM-ролей для кластера та вузлів, щоб вони мали відповідні дозволи для взаємодії з іншими сервісами AWS.